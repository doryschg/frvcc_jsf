package bo.gob.sin.sre.fac.frvcc.jsf.ventas.controller;

import java.io.ByteArrayInputStream;
import java.io.File;
import java.io.IOException;
import java.io.InputStream;
import java.io.Serializable;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.Base64;
import java.util.List;

import javax.annotation.PostConstruct;
import javax.enterprise.context.SessionScoped;
import javax.inject.Inject;
import javax.inject.Named;

import org.primefaces.event.FileUploadEvent;
import org.primefaces.model.DefaultStreamedContent;
import org.primefaces.model.UploadedFile;
import org.springframework.core.io.FileSystemResource;
import org.springframework.core.io.Resource;

import bo.gob.sin.sen.enco.model.ContextoJSF;
import bo.gob.sin.sre.fac.frvcc.jsf.ventas.model.VentaDto;
import bo.gob.sin.sre.fac.frvcc.jsf.ventas.service.EstandarService;
import bo.gob.sin.str.util.compresion.CompresorZip;

@Named
@SessionScoped
public class NotasController implements Serializable {
	
	private static final long serialVersionUID = 1L;
	
	// TODO DATA 
	private static String PLANTILLA_EXCEL = "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";
		
		
		// TODO INSTANCIA LOCAL
	DefaultStreamedContent file;
	private Resource srcfile;
	private List<VentaDto> notas;
	long ifc;
	long nit;
	

    @Inject
    private EstandarService service;
	
	
	public NotasController() {
		
	}
	
	@PostConstruct
    public void init() {
					 
    }
	
	private void getContext() {
		ContextoJSF contexto = new ContextoJSF();
		ifc = contexto.getUsuario().getPersonaId();
		nit = Long.parseLong(contexto.getUsuario().getNit());
	}
	
	public void removerNota(VentaDto nota) {
		
	}
	
	

//  TODO descarga de archivo 
	public void dwnldNotaExcel() throws IOException {
		try {
			byte[] vArchivoDecodificado = Base64.getDecoder().decode(PLANTILLA_EXCEL.getBytes());
			InputStream vArchivoXlsStream = new ByteArrayInputStream(vArchivoDecodificado);
			setFile(new DefaultStreamedContent(vArchivoXlsStream,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;","PlantillaRegistroNotas" + ".xlsx"));
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	
	//  TODO LEER ARCHIVO
	public void getFileData(FileUploadEvent event) {
		
		try {
			UploadedFile upldFile = event.getFile();
			srcfile = getUserFileResource(upldFile);
			//byte[] vArchivo =comprimirArchivo(file);
			System.out.println("Archivos size "+upldFile.getSize() +""+upldFile.getFileName());
			
		} catch (IOException e) {
			e.printStackTrace();
		}

	}
	
	//  TODO CONVIERTE ARCHIVO A ZIP 	
	public static Resource getUserFileResource(UploadedFile pFile) throws IOException {
		String vFilename = pFile.getFileName().replace(".xlsx", "");
		Path tempFile = Files.createTempFile(vFilename, ".zip");

		Files.write(tempFile,CompresorZip.zipBytes(pFile.getFileName(), pFile.getContents()));
		System.out.println("uploading: " + tempFile);
		File file = tempFile.toFile();
		return new FileSystemResource(file);
	}
	
	
	// -------------------------- GETTERS AND SETTERS ------------------------------
	
	public DefaultStreamedContent getFile() {
        return file;
    }
	
	public void setFile(DefaultStreamedContent file) {
		this.file = file;
	}

	public List<VentaDto> getNotas() {
		return notas;
	}

	public void setNotas(List<VentaDto> notas) {
		this.notas = notas;
	}
	

}
